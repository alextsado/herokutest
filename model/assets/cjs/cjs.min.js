var cjs=function(a){var b=function(a,b){var d=c._;if(arguments.length===0)return c.create("constraint",undefined);if(d.isString(a))return b===!0?c.create("constraint",a):c.create("constraint",a);if(d.isFunction(a))return b===!0?c.create("constraint",a,!0):c.create("constraint",a);if(c.is_fsm(a))return c.create("fsm_constraint",a,b);if(d.has(a,"condition")&&d.has(a,"value")){var e=d.toArray(arguments);return e.unshift("conditional_constraint"),c.create.apply(c,e)}return c.constraint.apply(c,arguments)},c=function(){return b.apply(this,arguments)};c.$=c.query=function(a,b){var d=c._;return d.isString(a)?c.create("selector_constraint",a,b):c.create("constraint",a,b)};var d={};c.define=function(a,b){d[a]=b},c.create=function(b){if(d.hasOwnProperty(b)){var c=d[b],e=[].slice.call(arguments,1);return c.apply(a,e)}return undefined};var e={};c.type=function(a,b){if(arguments.length===1)return e[a];arguments.length>1&&(e[a]=b)};if(typeof exports!="undefined")c._is_node=!0,typeof module!="undefined"&&module.exports&&(exports=module.exports=c),exports.cjs=c;else{c._is_node=!1;var f=a.cjs;a.cjs=c,c.noConflict=function(){return a.cjs=f,c}}return c.Exception=function(a){var b=Error.prototype.constructor.apply(this,arguments);for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);this.message=b.message},c.Exception.prototype=new Error,c._debug=!1,c.version="0.6",c}(this);((function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new E(a)};a._=w,w.VERSION="1.3.1";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a))return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a))return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){d==0?b[0]=a:(c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a)}),b},w.sortBy=function(a,b,c){return w.pluck(w.map(a,function(a,d,e){return{value:a,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?a.toArray?a.toArray():w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):w.values(a):[]},w.size=function(a){return w.toArray(a).length},w.first=w.head=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return w.reduce(d,function(c,d,f){if(0==f||(b===!0?w.last(c)!=d:!w.include(c,d)))c[c.length]=d,e[e.length]=a[f];return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1));return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(a,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var i=function(){e=null,g&&a.apply(c,d),h()};e||(e=setTimeout(i,b)),f?g=!0:a.apply(c,d),h(),f=!0}},w.debounce=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.mixin=function(a){x(w.functions(a),function(b){G(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D=function(a){return a.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};w.template=function(a,b){var c=w.templateSettings,d="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+a.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(c.escape||C,function(a,b){return"',_.escape("+D(b)+"),'"}).replace(c.interpolate||C,function(a,b){return"',"+D(b)+",'"}).replace(c.evaluate||C,function(a,b){return"');"+D(b).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",e=new Function("obj","_",d);return b?e(b,w):function(a){return e.call(this,a,w)}},w.chain=function(a){return w(a).chain()};var E=function(a){this._wrapped=a};w.prototype=E.prototype;var F=function(a,b){return b?w(a).chain():a},G=function(a,b){E.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),F(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];E.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],F(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];E.prototype[a]=function(){return F(b.apply(this._wrapped,arguments),this._chain)}}),E.prototype.chain=function(){return this._chain=!0,this},E.prototype.value=function(){return this._wrapped}})).call(cjs),function(){function t(a,c,d,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[b]===d){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[b]=d,j.sizset=h);if(j.nodeName.toLowerCase()===c){k=j;break}j=j[a]}e[h]=k}}}function u(a,c,d,e,f,g){for(var h=0,i=e.length;h<i;h++){var k=e[h];if(k){var l=!1;k=k[a];while(k){if(k[b]===d){l=e[k.sizset];break}if(k.nodeType===1){g||(k[b]=d,k.sizset=h);if(typeof c!="string"){if(k===c){l=!0;break}}else if(j.filter(c,[k]).length>0){l=k;break}}k=k[a]}e[h]=l}}}if(cjs._is_node)return;var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,b="sizcache"+(Math.random()+"").replace(".",""),c=0,d=Object.prototype.toString,e=!1,f=!0,g=/\\/g,h=/\r\n/g,i=/\W/;[0,0].sort(function(){return f=!1,0});var j=function(b,c,e,f){e=e||[],c=c||document;var g=c;if(c.nodeType!==1&&c.nodeType!==9)return[];if(!b||typeof b!="string")return e;var h,i,k,n,o,q,r,s,t=!0,u=j.isXML(c),w=[],x=b;do{a.exec(""),h=a.exec(x);if(h){x=h[3],w.push(h[1]);if(h[2]){n=h[3];break}}}while(h);if(w.length>1&&m.exec(b))if(w.length===2&&l.relative[w[0]])i=v(w[0]+w[1],c,f);else{i=l.relative[w[0]]?[c]:j(w.shift(),c);while(w.length)b=w.shift(),l.relative[b]&&(b+=w.shift()),i=v(b,i,f)}else{!f&&w.length>1&&c.nodeType===9&&!u&&l.match.ID.test(w[0])&&!l.match.ID.test(w[w.length-1])&&(o=j.find(w.shift(),c,u),c=o.expr?j.filter(o.expr,o.set)[0]:o.set[0]);if(c){o=f?{expr:w.pop(),set:p(f)}:j.find(w.pop(),w.length!==1||w[0]!=="~"&&w[0]!=="+"||!c.parentNode?c:c.parentNode,u),i=o.expr?j.filter(o.expr,o.set):o.set,w.length>0?k=p(i):t=!1;while(w.length)q=w.pop(),r=q,l.relative[q]?r=w.pop():q="",r==null&&(r=c),l.relative[q](k,r,u)}else k=w=[]}k||(k=i),k||j.error(q||b);if(d.call(k)==="[object Array]")if(!t)e.push.apply(e,k);else if(c&&c.nodeType===1)for(s=0;k[s]!=null;s++)k[s]&&(k[s]===!0||k[s].nodeType===1&&j.contains(c,k[s]))&&e.push(i[s]);else for(s=0;k[s]!=null;s++)k[s]&&k[s].nodeType===1&&e.push(i[s]);else p(k,e);return n&&(j(n,g,e,f),j.uniqueSort(e)),e};j.uniqueSort=function(a){if(r){e=f,a.sort(r);if(e)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},j.matches=function(a,b){return j(a,null,null,b)},j.matchesSelector=function(a,b){return j(b,null,null,[a]).length>0},j.find=function(a,b,c){var d,e,f,h,i,j;if(!a)return[];for(e=0,f=l.order.length;e<f;e++){i=l.order[e];if(h=l.leftMatch[i].exec(a)){j=h[1],h.splice(1,1);if(j.substr(j.length-1)!=="\\"){h[1]=(h[1]||"").replace(g,""),d=l.find[i](h,b,c);if(d!=null){a=a.replace(l.match[i],"");break}}}}return d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]),{set:d,expr:a}},j.filter=function(a,b,c,d){var e,f,g,h,i,k,m,n,o,p=a,q=[],r=b,s=b&&b[0]&&j.isXML(b[0]);while(a&&b.length){for(g in l.filter)if((e=l.leftMatch[g].exec(a))!=null&&e[2]){k=l.filter[g],m=e[1],f=!1,e.splice(1,1);if(m.substr(m.length-1)==="\\")continue;r===q&&(q=[]);if(l.preFilter[g]){e=l.preFilter[g](e,r,c,q,d,s);if(!e)f=h=!0;else if(e===!0)continue}if(e)for(n=0;(i=r[n])!=null;n++)i&&(h=k(i,e,n,r),o=d^h,c&&h!=null?o?f=!0:r[n]=!1:o&&(q.push(i),f=!0));if(h!==undefined){c||(r=q),a=a.replace(l.match[g],"");if(!f)return[];break}}if(a===p){if(f!=null)break;j.error(a)}p=a}return r},j.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var k=j.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9||d===11){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(h,"");for(a=a.firstChild;a;a=a.nextSibling)e+=k(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=k(c));return e},l=j.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!i.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&j.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!i.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&j.filter(b,a,!0)}},"":function(a,b,d){var e,f=c++,g=u;typeof b=="string"&&!i.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("parentNode",b,f,a,e,d)},"~":function(a,b,d){var e,f=c++,g=u;typeof b=="string"&&!i.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("previousSibling",b,f,a,e,d)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(g,"")+" ";if(f)return a;for(var h=0,i;(i=b[h])!=null;h++)i&&(e^(i.className&&(" "+i.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(i):c&&(b[h]=!1));return!1},ID:function(a){return a[1].replace(g,"")},TAG:function(a,b){return a[1].replace(g,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||j.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&j.error(a[0]);return a[0]=c++,a},ATTR:function(a,b,c,d,e,f){var h=a[1]=a[1].replace(g,"");return!f&&l.attrMap[h]&&(a[1]=l.attrMap[h]),a[4]=(a[4]||a[5]||"").replace(g,""),a[2]==="~="&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not"){if(!((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))){var g=j.filter(b[3],c,d,!0^f);return d||e.push.apply(e,g),!1}b[3]=j(b[3],null,null,c)}else if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return b},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!j(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}j.error(e)},CHILD:function(a,c){var d,e,f,g,h,i,j,k=c[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":d=c[2],e=c[3];if(d===1&&e===0)return!0;f=c[0],g=a.parentNode;if(g&&(g[b]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[b]=f}return j=a.nodeIndex-e,d===0?j===0:j%d===0&&j/d>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=j.attr?j.attr(a,c):l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&j.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));l.match.globalPOS=m;var p=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,e=b||[];if(d.call(a)==="[object Array]")Array.prototype.push.apply(e,a);else if(typeof a.length=="number")for(var f=a.length;c<f;c++)e.push(a[c]);else for(;a[c];c++)e.push(a[c]);return e}}var r,s;document.documentElement.compareDocumentPosition?r=function(a,b){return a===b?(e=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){if(a===b)return e=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,f=[],g=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)f.unshift(j),j=j.parentNode;j=i;while(j)g.unshift(j),j=j.parentNode;c=f.length,d=g.length;for(var k=0;k<c&&k<d;k++)if(f[k]!==g[k])return s(f[k],g[k]);return k===c?s(a,g[k],-1):s(f[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=document.createElement("div"),b="script"+(new Date).getTime(),c=document.documentElement;a.innerHTML="<a name='"+b+"'/>",c.insertBefore(a,c.firstChild),document.getElementById(b)&&(l.find.ID=function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d?d.id===a[1]||typeof d.getAttributeNode!="undefined"&&d.getAttributeNode("id").nodeValue===a[1]?[d]:undefined:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),c.removeChild(a),c=a=null}(),function(){var a=document.createElement("div");a.appendChild(document.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),document.querySelectorAll&&function(){var a=j,b=document.createElement("div"),c="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)return;j=function(b,d,e,f){d=d||document;if(!f&&!j.isXML(d)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(g&&(d.nodeType===1||d.nodeType===9)){if(g[1])return p(d.getElementsByTagName(b),e);if(g[2]&&l.find.CLASS&&d.getElementsByClassName)return p(d.getElementsByClassName(g[2]),e)}if(d.nodeType===9){if(b==="body"&&d.body)return p([d.body],e);if(g&&g[3]){var h=d.getElementById(g[3]);if(!h||!h.parentNode)return p([],e);if(h.id===g[3])return p([h],e)}try{return p(d.querySelectorAll(b),e)}catch(i){}}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var k=d,m=d.getAttribute("id"),n=m||c,o=d.parentNode,q=/^\s*[+~]/.test(b);m?n=n.replace(/'/g,"\\$&"):d.setAttribute("id",n),q&&o&&(d=d.parentNode);try{if(!q||o)return p(d.querySelectorAll("[id='"+n+"'] "+b),e)}catch(r){}finally{m||k.removeAttribute("id")}}}return a(b,d,e,f)};for(var d in a)j[d]=a[d];b=null}(),function(){var a=document.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(document.createElement("div"),"div"),d=!1;try{b.call(document.documentElement,"[test!='']:sizzle")}catch(e){d=!0}j.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!j.isXML(a))try{if(d||!l.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&a.document.nodeType!==11)return f}}catch(g){}return j(e,null,null,[a]).length>0}}}(),function(){var a=document.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!a.getElementsByClassName||a.getElementsByClassName("e").length===0)return;a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}(),document.documentElement.contains?j.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:document.documentElement.compareDocumentPosition?j.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:j.contains=function(){return!1},j.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var v=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=l.match.PSEUDO.exec(a))f+=d[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)j(a,g[h],e,c);return j.filter(f,e)};cjs.Sizzle=j}(),function(a){var b=a._,c=/-([a-z]|[0-9])/ig,d=/^-ms-/,e=function(a,b){return String(b).toUpperCase()};b.mixin({remove_index:function(a,b,c){var d=a.slice((c||b)+1||a.length);return a.length=b<0?a.length+b:b,a.push.apply(a,d)},remove:function(a,c){var d=b.index_of(a,c);d>=0&&b.remove_index(a,d)},remove_all:function(a,c){var d;do d=b.index_of(a,c),d>=0&&b.remove_index(a,d);while(d>=0)},index_of:function(a,c,d){return d===undefined&&(d=function(a,b){return a===b}),b.index_where(a,function(a){return d(c,a)})},index_where:function(a,b){var c,d=a.length;for(c=0;c<d;c++)if(b(a[c],c))return c;return-1},clear:function(a){a.length=0},insert_at:function(a,b,c){var d;return c===undefined?a.push(b):(d=a.slice(c),a.length=c,a.push(b),a.push.apply(a,d))},set_index:function(a,c,d){if(c>=0&&c<a.length&&d>=0&&d<a.length){var e=a[c];return b.remove_index(a,c),b.insert_at(a,e,d),e}return!1},diff:function(a,c,d){var e=b.clone(a),f=b.clone(c),g=[],h=[],i=[],j=b.clone(e),k=b.clone(f),l,m;d===undefined&&(d=function(a,b){return a===b});for(l=0;l<j.length;l++){var n=j[l],o=b.index_of(k,n,d);if(o>=0)b.remove_index(k,o);else{var p={item:n,index:l};b.remove_index(j,l),l--,g.push(p)}}j=b.clone(e);for(l=0;l<f.length;l++){var q=f[l],r=b.index_of(j,q,d);if(r>=0)b.remove_index(j,r);else{var s={item:q,index:l};h.push(s)}}var t=b.clone(e);for(l=g.length-1;l>=0;l--){var u=g[l].index;b.remove_index(t,u)}for(l=0;l<h.length;l++)b.insert_at(t,h[l].item,h[l].index);var v=function(a){b.any(h,function(b){return b.index===a})},w=[];for(l=0;l<t.length;l++){var x=f[l];if(!v(l))for(m=l+1;m<t.length;m++)if(!v(l)&&d(t[m],x)){w.push({from:m,to:l,from_item:t[m],to_item:t[l]});var y=t[m];t[m]=t[l],t[l]=y;break}}for(l=0;l<w.length;l++){var z=w[l],A={from_index:z.from,to_index:z.to,item:z.from_item},B={from_index:z.to+1,to_index:z.from,item:z.to_item};A.from_index!==A.to_index&&i.push(A),B.from_index!==B.to_index&&i.push(B)}return{removed:g,added:h,moved:i}},proto_extend:function(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype,b.prototype.constructor===Object.prototype.constructor&&(b.prototype.constructor=b)},camel_case:function(a){return a.replace(d,"ms-").replace(c,e)}}),b.isTextElement=function(a){return!!a&&a.nodeType===3},b.isCommentElement=function(a){return!!a&&a.nodeType===8}}(cjs),function(a){var b=a._,c=function(){this.outgoingEdges=[],this.incomingEdges=[]};(function(a){var c=a.prototype;c.addOutgoingEdge=function(a){this.outgoingEdges.push(a)},c.addIncomingEdge=function(a){this.incomingEdges.push(a)},c.removeOutgoingEdge=function(a){b.remove(this.outgoingEdges,a)},c.removeIncomingEdge=function(a){b.remove(this.incomingEdges,a)},c.getOutgoing=function(){return this.outgoingEdges},c.getIncoming=function(){return this.incomingEdges},c.destroy=function(){this.incomingEdges.forEach(function(a){var b=a.fromNode;b.removeOutgoingEdge(a)}),b.clear(this.incomingEdges),this.outgoingEdges.forEach(function(a){var b=a.toNode;b.removeIncomingEdge(a)}),b.clear(this.outgoingEdges)},c.pointsAt=function(a){a=a===!0;var c=[],d;for(d=0;d<this.outgoingEdges.length;d++){var e=this.outgoingEdges[d],f=e.toNode;b.contains(c,f)||(c.push(f),a&&(c=b.unique(c,f.pointsAt(!0))))}return c},c.pointsAtMe=function(a){a=a===!0;var c=[],d;for(d=0;d<this.incomingEdges.length;d++){var e=this.incomingEdges[d],f=e.fromNode;b.contains(c,f)||(c.push(f),a&&(c=b.unique(c,f.pointsAtMe(!0))))}return c},c.getEdgeTo=function(a){var b;for(b=0;b<this.outgoingEdges.length;b++){var c=this.outgoingEdges[b];if(c.fromNode===this&&c.toNode===a)return c}return null},c.hasEdgeTo=function(a){return this.getEdgeTo(a)!==null}})(c);var d=function(a,b){this.fromNode=a,this.toNode=b},e=function(){};(function(a){var b=a.prototype;b.create_node=function(){var a=new c;return this.addNode(a),a},b.hasEdge=function(a,b){var c,e,f;return a instanceof d?(f=a,c=f.fromNode,e=f.toNode):(c=a,e=b),c.hasEdgeTo(e)},b.getEdge=function(a,b){return a.getEdgeTo(b)},b.doAddEdge=function(a){return a.fromNode.addOutgoingEdge(a),a.toNode.addIncomingEdge(a),a},b.addEdge=function(a,b){var c,e,f;return a instanceof d?(f=a,c=f.fromNode,e=f.toNode):(c=a,e=b,f=new d(c,e)),this.hasEdge(c,e)?null:this.doAddEdge(f)},b.removeEdge=function(a,b){var c=this.getEdge(a,b);return c!==null&&(a.removeOutgoingEdge(c),b.removeIncomingEdge(c)),c},b.hasNode=function(a){return a instanceof c},b.addNode=function(){},b.removeNode=function(a){a.destroy()}})(e),a.define("graph",function(){return new e}),a.type("node",c),a.type("edge",d)}(cjs),function(a){var b=a._,c=a.type("node"),d=a.type("edge"),e=0,f=function(a,d){c.call(this),this.obj=a,this.ood=!0,this.value=null,this.options=b.extend({auto_add_outgoing_dependencies:!0,auto_add_incoming_dependencies:!0},d),this.timestamp=0,this.obj.__constraint_solver_node__=this,this.id=e++};b.proto_extend(f,c),function(b){var c=b.prototype;c.cs_eval=function(){return this.obj.cs_eval()},c.nullify=function(b){this.ood=!0,a._debug&&(this.nullified_reason_chain=b)},c.getId=function(){return this.id}}(f);var g=function(a,b){d.call(this,a,b),this.timestamp=0};b.proto_extend(g,d);var h=function(){this.graph=a.create("graph"),this.stack=[],this.listeners=[]};(function(d){var e=d.prototype;e.getNode=function(a){var b=a.__constraint_solver_node__||null;return b},e.hasNode=function(a){return this.getNode(a)!==null},e.addObject=function(b,c){var d=this.getNode(b);return d===null&&(d=new f(b,c),this.graph.addNode(d),a._debug_constraint_solver&&this.objToNode.set(b,d)),d},e.removeObject=function(b){var c=this.getNode(b);c!==null&&(this.graph.removeNode(c),delete b.__constraint_solver_node__,this.notify({type:"node_removed",node:c,obj:b})),a._debug_constraint_solver&&this.objToNode.unset(b)},e.addDependency=function(a,b){var c=this.getNode(a),d=this.getNode(b);return this.addNodeDependency(c,d)},e.addNodeDependency=function(a,b){var c=new g(a,b);return this.graph.addEdge(c),this.notify({type:"dependency_added",fromNode:a,toNode:b,nodes:[a,b]}),c},e.getNodeDependency=function(a,b){return this.graph.getEdge(a,b)},e.removeDependency=function(a,b){var c=this.getNode(a),d=this.getNode(b);this.removeNodeDependency(c,d)},e.removeNodeDependency=function(a,b){this.graph.removeEdge(a,b),this.notify({type:"dependency_removed",fromNode:a,toNode:b,nodes:[a,b]})},e.dependsOnMe=e.influences=function(a,b){return this.get_outgoing(a,b)},e.dependsOn=function(a,b){return this.get_incoming(a,b)},e.isOOD=function(a){var b=this.getNode(a);return b!==null&&b.ood},e.nullify=function(a){var b=this.doNullify(a);return b},e.doNullify=function(a){var b=this.getNode(a),c=this.nullifyNode(b);return this.notify({type:"root_nullify",node:b}),c},e.nullifyAndEval=function(a){var b=this.doNullifyAndEval(a);return b},e.doNullifyAndEval=function(a){var b=this.getNode(a),c=this.nullifyAndEvalNode(b);return this.notify({type:"root_nullify",node:b}),c},e.get_outgoing=function(a,b){return this.get_node_outgoing(this.getNode(a),b).map(function(a){return a.obj})},e.get_node_outgoing=function(a,b){return a.pointsAt(b)},e.get_incoming=function(a,b){return this.get_node_incoming(this.getNode(a),b).map(function(a){return a.obj})},e.get_node_incoming=function(a,b){return a.pointsAtMe(b)},e.doNullifyNode=function(a,b,c,d){d===undefined&&(d=this);var e,f;a.nullify(b),this.notify({type:"nullify",node:a,reason:b}),f=a.getOutgoing();for(e=0;e<f.length;e++){var g=f[e],h=g.toNode;if(g.timestamp<h.timestamp){var i=g.toNode,j=a;j.options.auto_add_outgoing_dependencies&&i.options.auto_add_incoming_dependencies?(this.removeNodeDependency(a,h),e--):c.call(d,h,b.concat(a.obj))}else h.ood||c.call(d,h,b.concat(a.obj))}},e.nullifyNode=function(a,b){b===undefined&&(b=[]),this.doNullifyNode(a,b,this.nullifyNode)},e.nullifyAndEvalNode=function(a,b){return b===undefined&&(b=[]),this.doNullifyNode(a,b,this.nullifyAndEvalNode),this.getNodeValue(a)},e.getValue=function(a){return this.getNodeValue(this.getNode(a))},e.getNodeValue=function(a){var c=b.last(this.stack);if(c){var d=this.getNodeDependency(a,c);d||a.options.auto_add_outgoing_dependencies&&c.options.auto_add_incoming_dependencies&&(d=this.addNodeDependency(a,c)),d!==null&&(d.timestamp=c.timestamp+1)}return a.ood&&(this.stack.push(a),this.doEvalNode(a),this.stack.pop()),a.value},e.doEvalNode=function(a){a.ood=!1,a.value=a.cs_eval(),a.timestamp++},e.doEval=function(a){return this.doEvalNode(this.getNode(a))},e.dependency_paths=function(a){var b=this.getNode(a),c=b.outgoingPaths(),d=c.map(function(a){var b=a.map(function(a){return a.obj});return b});return d},e.notify=function(a){b(this.listeners).chain().filter(function(b){return b.filter(a)}).map(function(b){b.notify(a)})};var h=0;e.on=e.add_listener=function(d,e){var f=this,g=function(){return!0},i=function(){return!0},j=function(a){var c=a.nodes||[a.node];return g(a.type)&&b.any(c,i)},k=b.last(arguments),l=null,m=null;arguments.length>=2&&(l=d),arguments.length>=3&&(m=e);if(l!==null)if(b.isFunction(l))arguments.length===2?j=d:arguments.length>=3&&(g=d);else if(b.isString(l))if(l==="*")g=function(){return!0};else{var n=l.split(" ");g=function(a){return b.contains(n,a)}}if(m!==null){var o=[];b.isArray(m)?o=m:o=[m];var p=function(a,d){if(b.isNumber(d))return a.getId()===d;if(d instanceof c)return a===d;var e=f.getNode(d);return a===e};i=function(a){var b;for(b=0;b<o.length;b++){var c=o[b];if(p(a,c))return!0}return!1}}var q={filter:j,id:h,notify:k};return a._debug&&(q.interested_in_type=g,q.interested_in_node=i),this.listeners.push(q),h++,h},e.off=e.remove_listener=function(a){this.listeners=b.reject(this.listeners,function(b){return b.id===a})}})(h),a._constraint_solver=new h}(cjs),function(a){var b=a._,c=function(a,b){this._name=b,this.fsm=a};(function(a){var b=a.prototype;b.get_name=function(){return this._name},b.get_node=function(){return this.node}})(c);var d=function(a,b,c,d){this.fsm=a,this.from=b,this.to=c,this.name=d};(function(a){var c=a.prototype;c.get_from=function(){return this.from},c.get_to=function(){return this.to},c.get_name=function(){return this.name},c.run=function(){var a=b.toArray(arguments);a.unshift(this),a.unshift(this.get_to()),this.fsm.set_state.apply(this.fsm,a)}})(d);var e=function(a){this.state_name=a};(function(a){var d=a.prototype;d.matches=function(a){return a instanceof c?this.state_name===a.get_name():b.isString(a)?this.state_name===a:!1},d.is=function(a){return a==="state"}})(e);var f=function(){};(function(a){var b=a.prototype;b.matches=function(a){return a instanceof c},b.is=function(a){return a==="*"}})(f);var g=function(a,b,c){this.is_pre=a,this.from_state_selector=b,this.to_state_selector=c};(function(a){var b=a.prototype;b.matches=function(a,b){if(a instanceof d){var c=a.get_from(),e=a.get_to();return this.from_state_selector.matches(c)&&this.to_state_selector.matches(e)&&this.is_pre===b}return!1},b.is=function(a){return a==="transition"}})(g);var h=function(a){this.selectors=a};(function(a){var c=a.prototype;c.matches=function(){var a=arguments;return b.any(this.selectors,function(b){return b.matches.apply(b,a)})},c.is=function(a){return a==="multi"}})(h);var i=function(a){return a==="*"?new f:new e(a)},j=function(a){var c=a.split(",");if(c.length===1)return i(c[0]);var d=b.map(c,function(a){return i(a)});return new h(d)},k=function(a,b,c){var d,e,f=j(a),i=j(c);return b==="<->"?(d=new g(!1,f,i),e=new g(!1,i,f),new h(d,e)):b===">-<"?(d=new g(!0,f,i),e=new g(!0,i,f),new h(d,e)):b==="->"?new g(!1,f,i):b===">-"?new g(!0,f,i):b==="<-"?new g(!1,i,f):b==="-<"?new g(!0,i,f):null},l=function(a){var b=new RegExp("^([a-zA-Z0-9,\\-*]+)((<->|>-<|->|>-|<-|-<)([a-zA-Z0-9,\\-*]+))?$"),c=a.match(b);if(c===null)return null;if(c[2]===undefined){var d=c[1];return j(d)}var e=c[1],f=c[3],g=c[4];return k(e,f,g)},m=0,n=function(a,b){this.selector=a,this.callback=b,this.id=m++};(function(a){var b=a.prototype;b.interested_in=function(){return this.selector.matches.apply(this.selector,arguments)},b.run=function(){this.callback()}})(n);var o=function(){this.states=[],this.transitions=[],this._state=null,this.listeners=[],this.chain_state=null,this.did_transition=!1,this.blocked=!1,this.state=a.create("constraint",b.bind(function(){return this._state?this._state.get_name():null},this))};(function(a){var e=a.prototype;e.create_state=function(a){var b=new c(this,a);return this.states.push(b),b},e.add_state=function(a){var b=this.state_with_name(a);return b===null&&(b=this.create_state.apply(this,arguments),this.get_state()===null&&(this._state=b)),this.chain_state=b,this},e.state_with_name=function(a){var c=b.find(this.states,function(b){return b.get_name()===a});return c===undefined?null:c},e.get_state=function(){return this._state},e.add_transition=function(a,b,c){var d=this.chain_state,e=this.get_transition(d,b,c);return a.call(this,e,this),this},e.get_transition=function(a,c,e){var f=a,g=c;b.isString(a)||(f=a.get_name()),b.isString(c)||(g=c.get_name());var h=new d(this,f,g),i=this,j=function(){if(i.is(f)&&!i.is_blocked()){var a=b.toArray(arguments);e===!1?h.run.apply(h,a):b.defer(function(){h.run.apply(h,a)})}};return this.transitions.push(h),j},e.set_state=function(a,c){var d=this.get_state(),e=b.isString(a)?this.state_with_name(a):a;this.did_transition=!0,b.forEach(this.listeners,function(a){a.interested_in(c,!0)&&a.run(c,e,d)}),this._state=e,this.state.nullify(),b.forEach(this.listeners,function(a){a.interested_in(c,!1)&&a.run(c,e,d),a.interested_in(e)&&a.run(c,e,d)})},e.destroy=function(){delete this.states,delete this.transitions,delete this._state},e.starts_at=function(a){var b=this.state_with_name(a);return b===null&&(b=this.create_state(a)),this.did_transition||(this._state=b),this},e.is=function(a){var c=this.get_state();return c===null?!1:b.isString(a)?c.get_name()===a:c===a},e.on=e.addEventListener=function(a,c){var d;b.isString(a)?d=this.parse_selector(a):d=a;var e=new n(d,c);return this.listeners.push(e),this},e.off=e.removeEventListener=function(a){return this.listeners=b.reject(this.listeners,function(b){return b.callback===a}),this},e.last_callback=function(){var a=b.last(this.listeners);return a?a.callback:null},e.parse_selector=function(a){var b=l(a);if(b===null)throw new Error("Unrecognized format for state/transition spec. Please see documentation.");return b},e.block=function(){this.blocked=!0},e.unblock=function(){this.blocked=!1},e.is_blocked=function(){return this.blocked===!0}})(o);var p=function(){return new o};a.fsm=p,a.define("fsm",a.fsm),a.is_fsm=function(a){return a instanceof o}}(cjs),function(a,b){var c=a._,d=a._constraint_solver,e=function(){return(new Date).getTime()},f=function(a,b,c,d){this.context=d,this.update_interval=c,this.last_update=0,this.update_timeout=null,this.callback=b,this.constraint=a,this.last_val=null};(function(a){var d=a.prototype;d.run=function(){var a=this.context||b;this.last_update=e();var c=this.constraint.get();this.last_val!==c&&(this.callback.call(a,c,this.last_val),this.last_val=c)},d.on_change=function(){if(c.isNumber(this.update_interval)&&this.update_interval>=0){var a=e();a-this.last_update<this.update_interval?(this.__callback_args=arguments,c.has(this,"__callback_timeout")||(this.__callback_timeout=c.delay(c.bind(function(){this.run.apply(this,this.__callback_args),delete this.__callback_timeout,delete this.__callback_args},this),this.last_update+this.update_interval-a))):this.run.apply(this,arguments)}else this.run.apply(this,arguments)}})(f);var g=function(){var a=d.addObject(this);this.literal=!1,this.set.apply(this,arguments),this.listeners=[],this.cs_listener_id=null,this.history={value:undefined,time:undefined},this.id="constraint_"+a.getId(),this.destroy_callbacks=[],this.bindings=[],this.invalidate=c.bind(this.nullify,this)};(function(b){var g=b.prototype;g.destroy=function(){c.forEach(this.destroy_callbacks,function(a){a()}),c.forEach(this.bindings,function(a){a.destroy()}),d.removeObject(this)},g.on_destroy=function(){this.destroy_callbacks.push.apply(this.destroy_callbacks,arguments)},g.off_destroy=function(a){c.remove_all(this.destroy_callbacks,a)},g.nullify=function(){d.nullify(this)},g.nullifyAndEval=function(){var a=c.clone(this.history),b=d.nullifyAndEval(this);return this.history.value=a.value,this.history.time=a.time,b},g.cs_eval=function(){var b;return c.has(this,"value")&&(this.literal?b=this.value:c.isFunction(this.value)?b=this.value():b=a.get(this.value)),this.history.value=b,this.history.time=e(),b},g.set=function(b,d,e){var f=this.literal,g=this.value;return arguments.length<2?this.literal=!c.isFunction(b)&&!a.is_constraint(b):this.literal=d===!0,this.value=b,(f!==this.literal||g!==this.value)&&this.nullify(),c.isFunction(e)&&this.update(e),this},g.get=function(){return d.getValue(this)},g.update=function(a){if(arguments.length===0)this.nullify();else{var b=this,d=function(){b.nulllify()};c.isFunction(a)&&a(d)}return this},g._on=function(a,b){var e=d.getNode(this),f=d.add_listener(a,e,b);return c.bind(this._off,this,f)},g._off=function(a){d.remove_listener(a)},g.onChange=function(a,b,d){d=d||this;var e=new f(this,a,b,d);return this.listeners.push(e),this.is_ood&&c.defer(c.bind(this.update_on_change_listeners,this)),this.cs_listener_id===null&&(this.cs_listener_id=this._on("nullify",c.bind(this.update_on_change_listeners,this))),this.last_listener=e,this},g.offChange=function(a){return this.listeners=c.reject(this.listeners,function(b){return b===a||b.callback===a}),this.listeners.length===0&&this.cs_listener_id!==null&&(this._off(this.cs_listener_id),this.cs_listener_id=null),this},g.is_ood=function(){var b=a._constraint_solver.getNode(this);return b.isOOD()},g.update_on_change_listeners=function(){c.defer(c.bind(function(){c.forEach(this.listeners,function(a){a.on_change()})},this))},g.influences=g.depends_on_me=function(a){return d.influences(this,a)},g.depends_on=function(a){return d.dependsOn(this,a)},g.length=function(){var a=this.get();return a.length},g.push_binding=function(a){this.bindings.push(a)}})(g);var h=function(a,b,d,e){var f;return arguments.length===0?f=new g(undefined):arguments.length===1?f=new g(a):arguments.length===2&&c.isBoolean(b)?f=new g(a,b):f=new g(a,b,d,e),f};a.constraint=h,a.define("constraint",a.constraint),a.constraint.raw_mixin=function(b,d){g.prototype[b]=function(){var a=c.toArray(arguments);return a.unshift(this),d.apply(this,a)},a.constraint[b]=function(){var a=c.toArray(arguments);return d.apply(this,a)}},a.constraint.mixin=function(b,d){var e;c.isString(b)?(e={},e[b]=d):e=b,c.forEach(e,function(b,d){a.constraint.raw_mixin(d,function(){var d=c.toArray(arguments);return a.create("constraint",function(){var e=a.get(c.first(d));return b.apply(this,[e].concat(c.rest(d)))})})})},a.is_constraint=function(b,d){return b instanceof g?!0:d===!0?c.isArray(b)?c.any(b,function(b){return a.is_constraint(b,d)}):!1:!1},a.get=function(b,d){var e=b;while(a.is_constraint(e))e=e.get();return d===!0&&c.isArray(e)&&(e=c.map(e,function(b){return a.get(b,d)})),e},a.get_item=function(b,c,d){d=d!==!1;var e=a.get(b),f=a.get(c),g=e[f];if(d)while(a.is_constraint(g))g=a.get(g);return g}}(cjs,this),function(a){var b=a._;a.constraint.mixin({unit:function(a,b){return parseFloat(a)+String(b)},add:function(){var c=b.map(arguments,function(b){return a.get(b)});return b.reduce(c,function(a,b){return a+b},0)},sub:function(){var c=b.map(arguments,function(b){return a.get(b)}),d=b.first(c),e=b.rest(c);return b.reduce(e,function(a,b){return a-b},d)},mul:function(){var c=b.map(arguments,function(b){return a.get(b)});return b.reduce(c,function(a,b){return a*b},1)},div:function(){var c=b.map(arguments,function(b){return a.get(b)}),d=b.first(c),e=b.rest(c);return b.reduce(e,function(a,b){return a/b},d)},clone:function(a){return a},isNull:function(a){return a===null},isUndefined:function(a){return a===undefined},eq:function(a,b){return a==b},eqeq:function(a,b){return a===b},round:function(a){return Math.round(a)}}),a.constraint.raw_mixin("snapshot",function(b){var c=b.get(),d=a.create("constraint",c);return d.basis=b,d})}(cjs),function(a){var b=a._;a.constraint.raw_mixin("push",function(a){var c=a.get();return c.push.apply(c,b.rest(arguments)),c.nullify(),a}),a.constraint.raw_mixin("forEach",function(a,c,d,e){if(b.isFunction(c)){var f=a.get();b.forEach(f,c),a.onAdd(c)}return b.isFunction(d)&&a.onRemove(d),b.isFunction(e)&&a.onMove(d),a}),a.constraint.raw_mixin("map",function(c,d,e,f){var g=c.get();b.isUndefined(g)?g=[]:b.isArray(g)||(g=[g]);var h=b.map(g,d),i=a.create("constraint",function(){var a=c.get();b.isArray(a)||(a=[a]);var i=b.diff(g,a),j=b.clone(h);return b.forEach(i.removed,function(a){var c=j[a.index];b.isFunction(e)&&e(a.item,a.index,c),b.remove_index(j,a.index)}),b.forEach(i.added,function(a){var c;b.isFunction(d)&&(c=d(a.item,a.index)),b.insert_at(j,c,a.index)}),b.forEach(i.moved,function(a){b.isFunction(f)&&f(a.item,a.to_index,a.from_index),b.set_index(j,a.from_index,a.to_index)}),g=a,h=j,j});return i}),a.constraint.mixin({join:function(a,b){var c=a.join(b);return c},first:function(b){return a.get_item(b,0)},last:function(c){return a.get_item(c,b.size(c)-1)}}),a.constraint.raw_mixin("item",function(c){var d=b.rest(arguments);return a.create("constraint",function(){var e=a.get(c);return b.forEach(d,function(c){var d=a.get(c);!b.isUndefined(e)&&b.has(e,d)&&(e=e[d])}),a.get(e)})});var c=function(c){if(b.has(c,"__array_change_listener"))return c.__array_change_listener;var d=function(){var d=a.get(c,!0);return b.isArray(d)||(d=[d]),d},e=d(),f=function(){var a=d(),c=b.diff(e,a);b.forEach(c.removed,function(a){b.forEach(f.removed_listeners,function(b){b(a.item,a.index)})}),b.forEach(c.added,function(a){b.forEach(f.added_listeners,function(b){b(a.item,a.index)})}),b.forEach(c.moved,function(a){b.forEach(f.moved_listeners,function(b){b(a.item,a.to_index,a.from_index)})})};return f.added_listeners=[],f.removed_listeners=[],f.moved_listeners=[],f.empty_sub_listeners=function(){return b.isEmpty(f.added_listeners)&&b.isEmpty(f.removed_listeners)&&b.isEmpty(f.moved_listeners)},f.remove_self=function(){f.added_listeners=f.removed_listeners=f.moved_listeners=null},c.on_destroy(f.remove_self),c.onChange(f),f},d=function(a){var b=c(a);a.off_destroy(b.remove_self),b.remove_self(),a.offChange(b),delete a.__array_change_listener};a.constraint.raw_mixin("onAdd",function(a,b){var d=c(a);return d.added_listeners.push(b),a}),a.constraint.raw_mixin("offAdd",function(a,e){var f=c(a);return b.removeAll(f.added_listeners,e),f.has_no_sub_listeners()&&d(a),a}),a.constraint.raw_mixin("onRemove",function(a,b){var d=c(a);return d.removed_listeners.push(b),a}),a.constraint.raw_mixin("offRemove",function(a,e){var f=c(a);return b.removeAll(f.removed_listeners,e),f.has_no_sub_listeners()&&d(a),a}),a.constraint.raw_mixin("onMove",function(a,b){var d=c(a);return d.moved_listeners.push(b),a}),a.constraint.raw_mixin("offMove",function(a,e){var f=c(a);return b.removeAll(f.moved_listeners,e),f.has_no_sub_listeners()&&d(a),a}),a.constraint.mixin({pluck:function(a,c){var d=b.pluck(a,c);return d}}),a.constraint.mixin({filter:function(a,c){var d=b.filter(a,c);return d}}),a.concat=function(){var c=b.toArray(arguments),d=a.create("constraint",function(){return b.map(c,function(b){return a.get(b)}).join("")});return d}}(cjs),function(a){if(!a._is_node){var b=a._;a.define("input_value_constraint",function(b){var c=a.create("constraint",function(){return b.value}),d=function(){c.nullify()},e=function(){b.addEventListener("keyup",d),b.addEventListener("input",d),b.addEventListener("paste",d),b.addEventListener("propertychange",d)},f=function(){b.removeEventListener("keyup",d),b.removeEventListener("input",d),b.removeEventListener("paste",d),b.removeEventListener("propertychange",d)};return c.on_destroy(f),e(),c}),a.define("checked_inputs",function(c){var d=a.create("constraint",function(){return b.filter(c,function(a){return a.checked})}),e=function(){d.nullify()},f=function(){b.forEach(c,function(a){a.addEventListener("change",e)})},g=function(){b.forEach(c,function(a){a.removeEventListener("change",e)})};return d.on_destroy(g),f(),d}),a.define("selector_constraint",function(c,d){var e=[],f,g=function(){f.nullify()},h=function(){document.addEventListener("DOMSubtreeModified",g)},i=function(){document.removeEventListener("DOMSubtreeModified",g),b.forEach(e,function(a){a.removeEventListener("DOMAttrModified",g)})};return f=a.create("constraint",function(){var f=a.Sizzle.call(a.Sizzle,a.get(c),a.get(d,!0));return b.forEach(e,function(a){a.removeEventListener("DOMAttrModified",g)}),b.forEach(f,function(a){a.addEventListener("DOMAttrModified",g)}),e=f,f}),f.on_destroy(i),h(),f}),a.define("children_constraint",function(b){var c,d=function(){c.nullify()},e=function(){b.addEventListener("DOMSubtreeModified",d)},f=function(){b.removeEventListener("DOMSubtreeModified",d)};return c=a.create("constraint",function(){return b.childNodes}),c.on_destroy(f),e(),c}),a.define("text_constraint",function(b){var c,d=function(){c.nullify()},e=function(){b.addEventListener("DOMSubtreeModified",d)},f=function(){b.removeEventListener("DOMSubtreeModified",d)};return c=a.create("constraint",function(){return b.innerText}),c.on_destroy(f),e(),c}),a.define("html_constraint",function(b){var c,d=function(){c.nullify()},e=function(){b.addEventListener("DOMSubtreeModified",d)},f=function(){b.removeEventListener("DOMSubtreeModified",d)};return c=a.create("constraint",function(){return b.innerHTML}),c.on_destroy(f),e(),c}),a.define("attr_constraint",function(b,c){var d,e=function(){d.nullify()},f=function(){b.addEventListener("DOMAttrModified",e)},g=function(){b.removeEventListener("DOMAttrModified",e)};return d=a.create("constraint",function(){return b.style[c]}),d.on_destroy(g),f(),d}),a.define("css_constraint",function(c,d){var e,f=function(a){a.attrName==="style"&&e.nullify()},g=function(){c.addEventListener("DOMAttrModified",f)},h=function(){c.removeEventListener("DOMAttrModified",f)},i=b.camel_case(d);return e=a.create("constraint",function(){return c.style[i]}),e.on_destroy(h),g(),e})}}(cjs),function(a){a._is_node||(a.constraint.raw_mixin("css",function(b,c){if(arguments.length===2)return a.map(b,function(b){return a.create("css_constraint",b,c)});var d=a.binding.css.apply(a.binding,arguments);return b.push_binding(d),b}),a.constraint.raw_mixin("attr",function(b,c){if(arguments.length===2)return a.map(b,function(b){return a.create("attr_constraint",b,c)});var d=a.binding.attr.apply(a.binding,arguments);return b.push_binding(d),b}),a.constraint.raw_mixin("text",function(b){if(arguments.length===1)return a.map(b,function(b){return a.create("text_constraint",b)});var c=a.binding.text.apply(a.binding,arguments);return b.push_binding(c),b}),a.constraint.raw_mixin("html",function(b){if(arguments.length===1)return a.map(b,function(b){return a.create("html_constraint",b)});var c=a.binding.html.apply(a.binding,arguments);return b.push_binding(c),b}),a.constraint.raw_mixin("val",function(b){if(arguments.length===1)return a.map(b,function(b){return a.create("input_value_constraint",b)});var c=a.binding.val.apply(a.binding,arguments);return b.push_binding(c),b}),a.constraint.raw_mixin("children",function(b){if(arguments.length===1)return a.map(b,function(b){return a.create("children_constraint",b)});var c=a.binding.children.apply(a.binding,arguments);return b.push_binding(c),b}))}(cjs),function(a,b){if(!a._is_node){var c=a._,d={x:a.constraint(),y:a.constraint()};b.addEventListener("mousemove",function(a){d.x.set(a.pageX),d.y.set(a.pageY)}),a.mouse=d;var e={alt:!1,ctrl:!1,shift:!1},f={pressed:a.constraint([]),modifiers:a.constraint(e)},g=function(a){var b={alt:a.altKey,ctrl:a.ctrlKey,shift:a.shiftKey};c.isEqual(b,e)||(e=b,f.modifiers.set(e))},h=[];b.addEventListener("keydown",function(a){g(a);var b=a.keyCode;h=c.union(h,[b]),f.pressed.set(h)}),b.addEventListener("keyup",function(a){g(a);var b=a.keyCode;h=c.without(h,b),f.pressed.set(h)}),a.keyboard=f,a.time=a.constraint(function(){return(new Date).getTime()}),b.setInterval(c.bind(a.time.nullify,a.time),10),a.touches=a([]),b.addEventListener("touchstart",function(b){a.touches.set(b.touches)}),b.addEventListener("touchmove",function(b){a.touches.set(b.touches)}),b.addEventListener("touchend",function(b){a.touches.set(b.touches)})}}(cjs,this),function(a,b){var c=a._,d={linear:function(a,b,c,d){return a},_default:function(a){return a}},e={slow:600,fast:200,_default:400},f={speed:"_default",in_filter:function(a){return a},out_filter:function(a){return a},timing:"ease-in-out"},g=function(){return(new Date).getTime()},h=function(a,b,f){this.options=a,this.unfiltered_from=b,this.unfiltered_to=f,this.from=a.in_filter(this.unfiltered_from),this.to=a.in_filter(this.unfiltered_to),this.current=this.start,this.timing=c.isString(a.timing)?d[a.timing]||d._default:a.timing,this.speed=c.isString(a.speed)?e[a.speed]||e._default:a.speed,this.start_time=null,this.end_time=null,this.started=!1,this.done=!1};(function(a){var b=a.prototype;b.get=function(a){if(!this.started)return options.out_filter(this.from);if(this.done)return options.out_filter(this.to);a=a||g();var b=(a-this.start_time)/(this.end_time-this.start_time),d=this.timing(b,this.start_time,this.end_time,this.current),e;return c.isArray(this.from)&&c.isArray(this.to)&&c.size(this.from)===c.size(this.to)?e=c.map(this.from,function(a,b){var c=this.to[b];return c*d+a*(1-d)}):e=this.to*d+this.from*(1-d),this.options.out_filter(e)},b.start=function(){this.start_time=g(),this.end_time=this.start_time+this.speed,this.started=!0},b.stop=function(){return this.done=!0,this}})(h),a.constraint.raw_mixin("anim",function(d,e){e=c.extend({},f,e);var g=null,i=null;d.onChange(function(a,d){i!==null&&b.clearTimeout(i),g=new h(c.clone(e),d,a),g.start(),i=b.setTimeout(function(){i=null,g=null},g.speed)});var j=a.create("constraint",function(){if(g===null)return a.get(d);var b=g.get();return c.defer(function(){j.nullify()}),b});return j})}(cjs,this),function(a){var b=a._,c=function(a,c){this.options=b.clone(a),this.update=this.options.update||function(){},this._activated=!1,c!==!1&&this.activate()};(function(a){var c=a.prototype;c.activate=function(){this.is_activated()||(this._activated=!0,b.isFunction(this.options.activate)&&this.options.activate(),this.update())},c.deactivate=function(){this.is_activated()&&(this._activated=!1,b.isFunction(this.options.deactivate)&&this.options.deactivate())},c.destroy=function(){this.deactivate(),b.isFunction(this.options.destroy)&&this.options.destroy()},c.is_activated=function(){return this._activated}})(c);var d=function(a,b){return new c(a,b)};a.binding=d,a.define("binding",a.binding);var e=function(c){c=b.clone(c);var d=c.objs,e,f,g,h,i,j=function(){if(b.isFunction(c.activate_fn))return c.activate_fn.apply(this,arguments)},k=function(){if(b.isFunction(c.deactivate_fn))return c.deactivate_fn.apply(this,arguments)},l=function(){if(b.isFunction(c.update_fn))return c.update_fn.apply(this,arguments)},m=function(){if(b.isFunction(c.destroy_fn))return c.destroy_fn.apply(this,arguments)};if(a.is_constraint(d)){var n=function(){var a=d.get();return b.isArray(a)?a:[a]},o=b.map(n(),function(c){var d=a.create("binding",{activate:b.bind(j,c,c),deactivate:b.bind(k,c,c),update:b.bind(l,c,c),destroy:b.bind(m,c,c)},!1);return i&&i.is_activated()&&d.activate(),d}),p=b.clone(n()),q=function(){var c=n(),d=b.diff(p,c);b.forEach(d.added,function(c){var d=c.item,e=a.create("binding",{activate:b.bind(j,d,d),deactivate:b.bind(k,d,d),update:b.bind(l,d,d),destroy:b.bind(m,d,d)},!1);i&&i.is_activated()&&e.activate(),b.insert_at(o,e,c.index)}),b.forEach(d.removed,function(a){var c=o[a.index];c.destroy(),b.remove_index(o,a.index)}),b.forEach(d.moved,function(a){b.set_index(o,a.from_index,a.to_index)}),p=b.clone(c)};e=function(){b.isFunction(c.activate)&&c.activate(),b.forEach(o,function(a){a.activate()}),d.onChange(q,c.update_interval)},f=function(){b.forEach(o,function(a){a.deactivate()}),b.isFunction(c.deactivate)&&c.deactivate(),d.offChange(q)},g=function(){b.forEach(o,function(a){a.update()}),b.isFunction(c.update)&&c.update()},h=function(){b.forEach(o,function(a){a.destroy()}),b.isFunction(c.destroy)&&c.destroy()},i=a.create("binding",{activate:e,deactivate:f,update:g,destroy:h},!1)}else{b.isArray(d)||(d=[d]);var r=b.map(d,function(c){return a.create("binding",{activate:b.bind(j,c,c),deactivate:b.bind(k,c,c),update:b.bind(l,c,c),destroy:b.bind(m,c,c)})});e=function(){b.isFunction(c.activate)&&c.activate(),b.forEach(r,function(a){a.activate()})},f=function(){b.forEach(r,function(a){a.deactivate()}),b.isFunction(c.deactivate)&&c.deactivate()},g=function(){b.forEach(r,function(a){a.update()}),b.isFunction(c.update)&&c.update()},h=function(){b.forEach(r,function(a){a.destroy()}),b.isFunction(c.destroy)&&c.destroy()},i=a.create("binding",{activate:e,deactivate:f,update:g,destroy:h},!1)}return i};a.define("group_binding",e);var f=function(a){this.context=a,this.last_bindings=[],this.last_binding=null};(function(a){var c=a.prototype;c.forEach=function(a){b.forEach(this.context,a)},c.map=function(a){return b.map(this.context,a)}})(f),a.binding.raw_mixin=function(c,d){a.binding[c]=function(){return d.apply(this,arguments)},f.prototype[c]=function(){var d=this,e=b.toArray(arguments);return this.last_bindings=this.map(function(b){return this.last_binding=a.binding[c].apply(d,[b].concat(e)),this.last_binding}),this}},a.binding.mixin=function(c,d){var e;b.isString(c)?(e={},e[c]=d):e=c,b.forEach(e,function(c,d){a.binding.raw_mixin(d,c),b.has(a.constraint,d)||a.constraint.raw_mixin(d,function(b){var c=a.binding[d].apply(a.binding,arguments);return b.push_binding(c),b})})},a.binding.mixin("bind",function(b,c,d,e,f){var g=function(b){var e=a.get(c);d(b,e,c)},h;return h=a.create("group_binding",{objs:b,update_fn:g,activate:function(){a.is_constraint(c)&&c.onChange(h.update)},deactivate:function(){a.is_constraint(c)&&c.offChange(h.update)},update_interval:e},!1),f!==!1&&h.activate(),h})}(cjs),function(a){if(!a._is_node){var b=a._;a.binding.mixin({css:function(c,d,e){var f=b.camel_case(d),g=function(a,b){a.style[f]=b};return a.binding.bind(c,e,g)},attr:function(b,c,d){var e=function(a,b){a.setAttribute(c,b)};return a.binding.bind(b,d,e)},"class":function(c){var d=b.rest(arguments),e=a(function(){return b.map(d,function(b){return a.get(b)}).join(" ")}),f=function(a,b){a.className=b};return a.binding.bind(c,e,f)},html:function(b,c){var d=function(a,b){a.innerHTML=b};return a.binding.bind(b,c,d)},val:function(b,c){var d=function(a,b){a.val=b};return a.binding.bind(b,c,d)}});var c=function(a,b,c){var d=b.childNodes;if(d.length<=c)b.appendChild(a);else{var e=d[c];b.insertBefore(a,e)}},d=function(a){var b=a.parentNode;b!==null&&b.removeChild(a)},e=function(a,b){var c=a.childNodes;if(c.length>b){var e=c[b];d(e)}},f=function(a,b,d){var e=a.childNodes;if(e.length>d){var f=e[d];a&&(d<b&&b++,c(f,a,b))}},g=function(a){if(b.isElement(a)||b.isTextElement(a)||b.isCommentElement(a))return a;var c=document.createTextNode(a);return c};a.binding.mixin("children",function(d){var h=b.rest(arguments),i=a.create("constraint",function(){var c=b.map(h,function(b){return a.get(b)}),d=b.flatten(c);return d}),j=[],k=function(){var h=a.get(i,!0);b.isArray(h)||(h=[h]),h=b.flatten(h);if(b.isElement(d)){var k=b.diff(j,h),l=k.removed,m=k.added,n=k.moved;b.forEach(l,function(a){e(d,a.index)}),b.forEach(m,function(a){var b=g(a.item);c(b,d,a.index)}),b.forEach(n,function(a){f(d,a.to_index,a.from_index)})}else if(b.isTextElement(d)||b.isCommentElement(d))d.nodeValue=b.map(h,function(a){return String(a)}).join("");j=b.clone(h)};return a.create("binding",{update:k,activate:function(){b.times(d.childNodes.length,function(){d.removeChild(d.firstChild)}),j=[],a.is_constraint(i,!0)&&i.onChange(k)},deactivate:function(){i.offChange(k)}})}),a.define("dom_text",function(){var c=document.createTextNode(""),d=b.toArray(arguments);return d.unshift(c),a.binding.children.apply(a,d),c}),a.define("dom_comment",function(){var c=document.createComment(""),d=b.toArray(arguments);return d.unshift(c),a.binding.children.apply(a,d),c}),a.define("dom_element",function(c,d){var e=document.createElement(c),f=b.rest(arguments,2);return f.unshift(e),b.forEach(d,function(b,c){a.binding.attr(e,c,b)}),a.binding.children.apply(a,f),e}),a.binding.mixin("text",a.binding.children)}}(cjs),function(a){a._is_node||a.binding.mixin({val:function(b,c){var d=function(a,b){a.value=b};return a.binding.bind(b,c,d)}})}(cjs),function(a){var b=a._;a.on=function(a,c){var d=this,e=function(b){c.addEventListener(a,b)};return e.guard=function(e){return function(f){c.addEventListener(a,function(){var a=b.toArray(arguments);e.apply(d,a)&&f.apply(d,a)})}},e}}(cjs),function(a){var b=a._,c=function(c,d){var e=b.keys(d),f=[],g=[],h,i=function(){var d,e=a.get(c);if(!a.is_fsm(e))return undefined;var i=e.get_state();for(d=0;d<f.length;d++){var j=f[d];if(j.matches(i)){var k=g[d];return b.isFunction(k)?k(i):a.get(k)}}return h},j=a.create("constraint",i),k=function(){},l=function(c){var i=[];k();if(!a.is_fsm(c))return;f=b.map(e,function(a){return c.parse_selector(a)}),g=b.values(d),b.forEach(f,function(a){a.is("transition")?(c.on(a,function(){h=j.nullifyAndEval()}),i.push(b.bind(c.off,c,c.last_callback()))):(c.on(a,function(){h=j.nullifyAndEval()}),i.push(b.bind(c.off,c,c.last_callback())))}),k=function(){b.forEach(i,function(a){a()})}};return a.is_constraint(c)?(c.onChange(function(a){k(),l(a)}),l(c.get())):l(c),j};a.define("fsm_constraint",c),a.constraint.fsm=c}(cjs),function(a){var b=a._,c=function(c,d){var e=b.keys(d),f=b.map(e,function(a){return c.parse_selector(a)}),g=b.values(d),h,i=[],j=function(){c.on("*",function(){b.isUndefined(h)||h.deactivate()}),i.push(c.last_callback()),b.forEach(f,function(a,d){var e=g[d];a.is("transition")?(c.on(a,function(){h=undefined,e.activate(),e.deactivate()}),i.push(c.last_callback())):(c.on(a,function(){b.isUndefined(h)||h.deactivate(),e.activate(),h=e}),i.push(c.last_callback()),c.is(a)&&(e.activate(),h=e))})},k=function(){b.forEach(i,function(a){c.off(a)})},l=function(){b.forEach(g,function(a){a.is_activated()&&a.update()})},m=a.create("binding",{activate:j,deactivate:k,update:l});return m};a.define("fsm_binding",c),a.binding.mixin("bind_check_fsm",function(c,d,e,f){var g;if(a.is_fsm(d)){var h=d,i=e;g=f;var j={};return b.forEach(i,function(b,d){j[d]=a.binding.bind(c,b,g,!1)}),a.create("fsm_binding",h,j)}var k=d;return g=e,a.binding.bind(c,k,g)})}(cjs),function(a,b){var c=a._,d=function(d,e){var f=a.create("fsm").add_state("pending").add_transition(function(a){c.isNumber(e)&&b.setTimeout(function(){a("timeout")},e)},"rejected",!1).add_state("resolved").add_state("rejected").starts_at("pending"),g=f.get_transition("pending","resolved",!1),h=f.get_transition("pending","rejected",!1);c.isNumber(e)&&b.setTimeout(function(){h("timeout")},e);var i,j,k=function(a){i=a,g(a)},l=function(a){j=a,h(a)};d(k,l);var m=a.create("fsm_constraint",f,{pending:undefined,resolved:function(){return a.get(i)},rejected:function(){return a.get(j)}});return m.is_pending=function(){return m.$state.get()==="pending"},m.is_resolved=function(){return m.$state.get()==="resolved"},m.is_rejected=function(){return m.$state.get()==="rejected"},m.state=f,m};a.define("async_constraint",d),a.async=a.constraint.async=d}(cjs,this),function(a){var b=a._,c=function(){var c=b.map(arguments,function(c){var d={};return b.has(c,"condition")&&(b.isFunction(c.condition)?d.condition=a.create("constraint",c.condition):d.condition=c.condition),b.has(c,"value")&&(b.isFunction(c.value)?d.value=a.create("constraint",c.value):d.value=c.value),d}),d=function(){var d,e;for(d=0,e=c.length;d<c.length;d++){var f=c[d],g=f.condition,h=f.value;if(!b.has(f,"condition")||a.get(g))return a.get(h)}return undefined};return a.create("constraint",d)};a.define("conditional_constraint",c)}(cjs),function(a){var b=a._;a.__parsers={},a.__ir_builders={},a.__template_builders={};var c=/^#(\w+)$/;a.template=function(d,e,f,g){var h="handlebars",i,j=undefined,k={};arguments.length===1?i=d:arguments.length===2?(i=d,j=e):arguments.length===3?(i=d,j=e,k=f):(h=d,i=e,j=f,k=g);var l=i.match(c);if(!b.isNull(l)){var m=l[1],n=document.getElementsByTagName("script"),o=null;b.forEach(n,function(a){var b=a.getAttribute("type");if(b==="cjs/template"){var c=a.getAttribute("id");c===m&&(o=a)}}),b.isNull(o)?i="Could not find <script type='cjs/template' id='"+m+"'>(...)</script>":i=o.innerText}return a.__template_builders[h](i,j,k)}}(cjs),function(a){"use strict";var b=["-","!"],c=["+","-","*","/","&&","||","&","|","<<",">>","===","==",">=","<=","<",">"],d=/^\s+/,e=function(a){return a.replace(d,"")},f=function(a,b){this.expr=a,this.options=b,this.buffer=this.expr,this.curr_node=null};(function(a){var d=a.prototype;d.tokenize=function(){var a=[],b=this.buffer;while(this.buffer){this.gobble_expression();if(this.curr_node===!1)throw new Error("Unexpected "+this.buffer);a.push(this.curr_node);if(this.buffer===b)throw new Error("Could not parse "+this.buffer);b=this.buffer}return a.length===1?a=a[0]:a={type:"compound",statements:a},a},d.gobble_expression=function(){var a;this.curr_node=null;do{this.buffer=e(this.buffer),a=!1,a===!1&&(a=this.gobble_token()),a===!1&&(a=this.parse_fn_call()),a===!1&&(a=this.parse_parens()),a===!1&&(a=this.parse_binary_op()),a===!1&&(a=this.parse_unary_op());if(a)this.curr_node=a;else{var b=this.parse_separator();if(b)break}}while(a);return this.curr_node},d.gobble_token=function(){var a=!1;return a===!1&&this.curr_node===null&&(a=this.parse_variable()),a===!1&&(a=this.parse_dot_property()),a===!1&&(a=this.parse_square_brackets_property()),a===!1&&(a=this.parse_constant()),a};var f=new RegExp("^([A-Za-z_$][A-Za-z_$0-9]*)");d.parse_variable=function(){var a=this.buffer.match(f);if(a){var b=a[1];return this.buffer=this.buffer.substr(a[0].length),{type:"var",var_name:b,text:a[0]}}return!1},d.parse_dot_property=function(){if(this.buffer[0]==="."){if(this.curr_node===null)throw new Error("Unexpected .");this.buffer=this.buffer.substr(1);var a=this.parse_variable();if(a){var b={type:"prop",subtype:"dot",parent:this.curr_node,child:a};return b}throw new Error("Unexpected property '"+this.buffer[0]+"'")}return!1};var g=new RegExp("^\\["),h=new RegExp("^\\]");d.parse_square_brackets_property=function(){var a=[],b=this.buffer.match(g);if(b){a.push(this.buffer),this.buffer=this.buffer.substr(b[0].length),a.push(this.buffer);var c=this.curr_node;this.curr_node=null;var d=this.gobble_expression();if(d){b=this.buffer.match(h);if(b){a.push(this.buffer),this.buffer=this.buffer.substr(b[0].length),a.push(this.buffer);var e=a[0].substring(0,a[0].length-a[3].length),f=a[1].substring(0,a[1].length-a[2].length),i={type:"prop",subtype:"square_brackets",parent:c,child:d,outer_text:e,inner_text:f};return i}throw new Error("Unclosed [")}throw new Error("Unexpected property '"+b[1]+"'")}return!1};var i=new RegExp("^['\"]"),j=new RegExp("^(\\d+(\\.\\d+)?)");d.parse_constant=function(){var a,b;a=this.buffer.match(j);if(a)return this.buffer=this.buffer.substr(a[0].length),b={type:"constant",text:a[0],value:parseFloat(a[1])},b;a=this.buffer.match(i);if(a){var c=a[0],d=this.buffer.indexOf(c,c.length);if(d>=0){var e=this.buffer.substring(1,d);return b={type:"constant",text:this.buffer.substring(0,d+1),value:e},this.buffer=this.buffer.substr(d+1),b}throw new Error("Unclosed quote in "+a[0])}return!1};var k=new RegExp("^\\("),l=new RegExp("^\\s*,"),m=new RegExp("^\\s*\\)");d.parse_fn_call=function(){if(this.curr_node&&(this.curr_node.type==="prop"||this.curr_node.type==="var"||this.curr_node.type==="fn_call")){var a=this.buffer.match(k);if(a){var b=!1;this.buffer=this.buffer.substr(a[0].length);var c=[],d=this.curr_node;do{this.curr_node=null,b=this.gobble_expression(),c.push(b),a=this.buffer.match(l);if(a)this.buffer=this.buffer.substr(a[0].length);else{a=this.buffer.match(m);if(a){this.buffer=this.buffer.substr(a[0].length);break}}}while(b);var e={type:"fn_call",args:c,fn:d};return e}}return!1};var n=function(a,b){return a.substr(0,b.length)===b};d.parse_parens=function(){var a=this.buffer.match(k);if(a){this.buffer=this.buffer.substr(a[0].length);var b=this.curr_node;this.curr_node=null;var c=this.gobble_expression();a=this.buffer.match(m);if(a){this.buffer=this.buffer.substr(a[0].length);var d={type:"grouping",contents:c};return d}throw new Error("Unclosed (")}return!1},d.parse_unary_op=function(){var a,c;for(a=0,c=b.length;a<c;a+=1){var d=b[a];if(n(this.buffer,d)){this.buffer=this.buffer.substr(d.length);var e=this.gobble_expression(),f={type:"op",subtype:"unary",op:d,operands:[e]};return f}}return!1},d.parse_binary_op=function(){if(this.curr_node!==null){var a,b;for(a=0,b=c.length;a<b;a+=1){var d=c[a];if(n(this.buffer,d)){this.buffer=this.buffer.substr(d.length);var e=this.curr_node;this.curr_node=null;var f=this.gobble_expression(),g={type:"op",subtype:"binary",op:d,operands:[e,f]};return g}}}return!1};var o=new RegExp("^[;,]");d.parse_separator=function(){var a=this.buffer.match(o);if(a){this.buffer=this.buffer.substr(a[0].length);var b={type:"separator",separator:a[0]};return b}return!1}})(f);var g=function(a,b){var c=new f(a,b);return c.tokenize()};g.version="0.0.4",a.__parsers.expression=g}(cjs),function(a){function l(a){var b={},c=a.split(",");for(var d=0;d<c.length;d++)b[c[d]]=!0;return b}var b=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,c=/^<\/([-A-Za-z0-9_]+)[^>]*>/,d=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,e=l("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),f=l("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),g=l("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),h=l("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),i=l("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),j=l("script,style"),k=function(a,k){function r(a,b,c,j){b=b.toLowerCase();if(f[b])while(o.last()&&g[o.last()])s("",o.last());h[b]&&o.last()==b&&s("",b),j=e[b]||!!j,j||o.push(b);if(k.start){var l=[];c.replace(d,function(a,b){var c=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:i[b]?b:"";l.push({name:b,value:c,escaped:c.replace(/(^|[^\\])"/g,'$1\\"')})}),k.start&&k.start(b,l,j)}}function s(a,b){if(!b)var c=0;else for(var c=o.length-1;c>=0;c--)if(o[c]==b)break;if(c>=0){for(var d=o.length-1;d>=c;d--)k.end&&k.end(o[d]);o.length=c}}var l,m,n,o=[],p=a;o.last=function(){return this[this.length-1]};while(a){m=!0;if(!o.last()||!j[o.last()]){a.indexOf("<!--")==0?(l=a.indexOf("-->"),l>=0&&(k.comment&&k.comment(a.substring(4,l)),a=a.substring(l+3),m=!1)):a.indexOf("</")==0?(n=a.match(c),n&&(a=a.substring(n[0].length),n[0].replace(c,s),m=!1)):a.indexOf("<")==0&&(n=a.match(b),n&&(a=a.substring(n[0].length),n[0].replace(b,r),m=!1));if(m){l=a.indexOf("<");var q=l<0?a:a.substring(0,l);a=l<0?"":a.substring(l),k.chars&&k.chars(q)}}else a=a.replace(new RegExp("(.*)</"+o.last()+"[^>]*>"),function(a,b){return b=b.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),k.chars&&k.chars(b),""}),s("",o.last());if(a==p)throw"Parse Error: "+a;p=a}s()};a.__parsers.html=function(a,b){k(a,b)}}(cjs),function(a){function j(a,b){this.template=a.replace(/\r\n/g,f).replace(/\n/g,h),this.options=b||{},this.sections=[],this.tokens=["multi"],this.partials=[],this.buffer=this.template,this.state="static",this.setTag(["{{","}}"])}function k(a){if(!arguments.callee.sRE){var b=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+b.join("|\\")+")","g")}return a.replace(arguments.callee.sRE,"\\$1")}function l(a,b){var c=a.indexOf(b);return c<0?a:a.substring(0,c)}var b=a._,c={diagram:{sub_nodes:["state"]},"if":{sub_nodes:["elif","else"]}},d={state:{parent:"diagram",direct:!0}},e={elif:{follows:["if","elif"],direct:!0,or_parent:["if"]},"else":{follows:["if","elif"],direct:!0,or_parent:["if"]}};a.__parsers.handlebars=function(a,b){var c=new j(a,b);return c.tokenize()};var f="__CJS_CARRIAGE__",g=new RegExp(f,"g"),h="__CJS_NEWLINE__",i=new RegExp(h,"g");j.prototype={tokenize:function(){while(this.buffer)this.state==="static"?this.scanText():this.scanTag();if(this.sections.length>0)throw new Error("Encountered an unclosed section.");var a=this.template.replace(g,"\r\n").replace(i,"\n");return{partials:this.partials,tokens:this.tokens,content:a}},appendMultiContent:function(a){var b,c,d;for(b=0,c=this.sections.length;b<c;b++)d=this.sections[b][1],d=d[d.length-1][4]+=a},setTag:function(a){this.otag=a[0]||"{{",this.ctag=a[1]||"}}"},scanText:function(){var a=this.buffer.indexOf(this.otag);a===-1&&(a=this.buffer.length);var b=this.buffer.substring(0,a).replace(g,"\r\n").replace(i,"\n");b!==""&&(this.appendMultiContent(b),this.tokens.push(["static",b])),this.buffer=this.buffer.substring(a+this.otag.length),this.state="tag"},scanTag:function(){var a=this.ctag,f="^\\s*(#|\\^|/|=|!|<|>|&|\\{)?\\s*([^(?:\\}?"+k(a)+")]+)"+"\\s*"+"\\}?"+k(a)+"(.*)$";f=new RegExp(f);var g=this.buffer.match(f);if(!g)throw new Error('Encountered an unclosed tag: "'+this.otag+this.buffer+'"');var h=g[1],i=g[2].trim(),j=g[3],m=this.otag+this.buffer.substring(0,this.buffer.length-j.length),n=l(i," ");switch(h){case undefined:this.tokens.push(["mustache","etag",n,i]),this.appendMultiContent(m);break;case">":case"<":this.tokens.push(["mustache","partial",n,i]),this.partials.push(i),this.appendMultiContent(m);break;case"{":case"&":this.tokens.push(["mustache","utag",n,i]),this.appendMultiContent(m);break;case"!":break;case"=":this.setTag(i.split(" ")),this.appendMultiContent(m);break;case"#":case"^":var o=h==="#"?"section":"inverted_section",p=b.last(this.sections)||[],q=p[0],r=p[1],s=b.pluck(c,"sub_nodes"),t=!1;for(var u=0,v=s.length;u<v;u++)if(b.indexOf(s[u],q)>=0&&b.indexOf(s[u],n)>=0){t=!0;break}t&&(this.tokens=r,this.sections.pop()),this.appendMultiContent(m);if(b.has(d,n)){var w=d[n];if(w.direct===!0){var x=b.last(this.sections),y=x[0];if(y!==w.parent)throw new Error(n+" must be a direct child of "+parent)}else{var z=!1;for(var u=this.sections.length-1;u>=0;u--){var A=this.sections[u];if(A[0]===w.parent){z=!0;break}}if(!z)throw new Error(n+" must be a child of "+parent)}}if(b.has(e,n)){var B=b.last(this.tokens),C=B[2],D=e[n];if(D.direct&&b.indexOf(D.follows,C)<0){var x=b.last(this.sections)||[],y=x[0];if(b.indexOf(D.or_parent,y)<0){var E=b.clone(D.follows);E.length>1&&(E[E.length-1]="or "+b.last(E));var F;throw E.length>2?F=E.join(", "):F=E.join(" "),new Error(n+" must follow "+F)}}}block=["multi"],this.tokens.push(["mustache",o,n,i,"",block]),this.sections.push([n,this.tokens]),this.tokens=block;break;case"/":var p=b.last(this.sections)||[],q=p[0],r=p[1];if(!q)throw new Error("Closing unopened "+n);if(q!==n){var t=!1;if(b.has(c,n)){var G=c[n].sub_nodes;b.indexOf(G,q)>=0&&(t=!0)}if(!t)throw new Error("Unclosed section "+q);this.sections.pop(),p=b.last(this.sections)||[],q=p[0],r=p[1]}this.tokens=r,this.sections.pop(),this.appendMultiContent(m)}this.buffer=j,this.state="static"}}}(cjs),function(a){var b=a._,c=function(a,b){var c=a.split("/");this.type=c[0],this.subtype=c[1]||null,this.text=b,this.value=null,this.children=[],this.parent=null};(function(a){var c=a.prototype;c.push_child=function(b){this.children.push(b),b instanceof a&&b.set_parent(this)},c.insert_child_at=function(c,d){b.insert_at(this.children,c,d),c instanceof a&&c.set_parent(this)},c.set_children=function(c){this.children=c;var d=this;b.forEach(this.children,function(b){b instanceof a&&b.set_parent(d)})},c.child_index=function(a){return b.index_of(this.children,a)},c.set_value=function(a){this.value=a},c.set_parent=function(a){this.parent=a},c.remove_child=function(a){return b.remove(this.children,a),a.parent===this&&a.set_parent(null),a},c.to_str=function(c){b.isFunction(c)||(c=function(b){return b instanceof a?b.to_str(c):b});var d=b.map(this.children,function(a){return c(a)});return d.join("")}})(c);var d=function(a,e){var f=a[0],g=b.rest(a);if(f==="multi"){var h=b.map(g,function(a){return d(a,e)});return e.set_children(h),a}if(f==="static")return g[0];if(f==="mustache"){var i=g[0];g=b.rest(g);if(i==="etag"||i==="utag"){var j=new c("mustache/variable",g[1]);return j.set_value({var_name:g[0],escaped:i==="etag"}),j}if(i==="section"||i==="inverted_section"){var k=g[0],l=g[1],m=g[2],n=g[3],j=new c("mustache/"+i,m),o=l.indexOf(" "),p;return o<0?p=null:p=l.substring(o+1),j.set_value({tag:k,attributes:p}),d(n,j),j}if(i==="partial"){var k=g[0],l=g[1],j=new c("mustache/partial",l);return j.set_value(k),j}console.log("Unknown mustache type",i)}else console.log("Unknown type",f)},e=function(a,b){return a.type==="mustache"&&a.subtype==="section"&&a.value&&a.value.tag===b},f=function(a){if(e(a,"if")){var c,d,g=[];for(c=0,d=a.children.length;c<d;c++){var h=a.children[c];if(e(h,"if"))break;(e(h,"elif")||e(h,"else"))&&g.push(h)}var i=a.parent,j=i.child_index(a)+1;b.forEach(g,function(b){a.remove_child(b),i.insert_child_at(b,j),j+=1})}b.forEach(a.children,function(a){f(a)})},g=function(c){if(b.has(c,"value")&&!b.isNull(c.value))if(b.has(c.value,"attributes")&&!b.isNull(c.value.attributes)){var d=c.value.attributes,e=a.__parsers.expression(d);c.value.parsed_attributes=e}else if(b.has(c.value,"var_name")){var f=c.value.var_name,h=a.__parsers.expression(f);c.value.parsed_var_name=h}b.forEach(c.children,function(a){g(a)})},h=/\{cjs\{([#\/]?)(\d+)\}cjs\}/,i=function(a){var b=a,c=[],d;do{d=b.match(h);if(d){var e=b.indexOf(d[0]);e>0&&c.push(b.substr(0,e)),b=b.substr(e+d[0].length);var f=d[1],g=parseInt(d[2]);c.push({type:"handlebars",modifier:f,handlebar_id:g})}else c.push(b),b=""}while(b.length>0);return c},j=function(a){var b="{cjs{#"+a+"}cjs}";return b},k=function(a){var b="{cjs{/"+a+"}cjs}";return b},l=function(a){var b="{cjs{"+a+"}cjs}";return b},m=function(d){var e=[],f=0,g;g=function(a){if(a instanceof c){if(a.value){if(a.type==="mustache"){if(a.subtype==="section"){var b=f;e[b]=a,f++;var d=j(b)+a.to_str(g)+k(b);return d}var b=f;e[b]=a,f++;var d=l(b);return d}throw new Exception("Nothing but mustache expressions allowed at this stage of IR building")}return a.to_str(g)}return a};var h=[d],m=d.to_str(g);d.set_children([]),a.__parsers.html(m,{start:function(a,d,f){var g=b.last(h),j=new c("html/tag");j.value={tag_name:a},f||h.push(j),g.push_child(j);var k;j.attrs=[],b.forEach(d,function(a,c){var c=a.name,d=b.map(i(a.value),function(a){return b.isString(a)?a:(k=e[a.handlebar_id],a.modifier==="#"?k:a.modifier==="/"?!1:k)});j.attrs.push({name:c,value:b.compact(d)})})},end:function(a){var b=h.pop();if(b.value.tag_name!==a)throw new Exception("Could not resolve",a,b)},chars:function(a){var c;b.forEach(i(a),function(a){if(b.isString(a)){var d=b.last(h);d.push_child(a)}else{c=e[a.handlebar_id];if(a.modifier==="#"){c.set_children([]);var d=b.last(h);d.push_child(c),h.push(c)}else if(a.modifier==="/"){var f=h.pop();if(f!==c)throw new Exception("Out of order: ",f.text,c.text)}else{var d=b.last(h);d.push_child(c)}}})},comment:function(a){var d=b.last(h),e=new c("html/comment",a);d.push_child(e)}})};a.__ir_builders.handlebars=function(a,b){var e=new c("root",a.content);return d(a.tokens,e),f(e),g(e),m(e),e}}(cjs),function(a){var b=a._,c="span",d=function(a){var b=a.type;if(b==="prop"){var c=a.subtype,e=a.parent,f=a.child,g=d(e),h=d(f);if(c==="square_brackets")return f.type==="constant"&&f.subtype==="string"&&(h='"'+h+'"'),g+".item("+h+")";if(c==="dot")return g+".item('"+h+"')";console.log("Unknown type "+b+"/"+c)}else{if(b==="constant")return a.value;if(b==="var")return a.var_name;console.log("Unknown type "+b)}return"'todo'"},e={},f=function(a){var g="",h=b.isString(a)?"string":a.type;if(h==="root")a.children.length===1&&a.children[0].type==="html"?g="return "+f(a.children[0])+";":(g="return cjs.create('dom_element', '"+c+"', {} // (root)\n",b.forEach(a.children,function(a){var b=f(a);b&&(g+=", "+b)}),g+="\n); // (/root)");else if(h==="string"){var i=a.split("\n").join("\\n");g="cjs.create('dom_text', '"+i+"') // (text /)\n"}else if(h==="html"){var j=a.subtype;if(j==="tag"){var k=a.value.tag_name;g="cjs.create('dom_element', '"+k+"',",b.size(a.attrs)===0?g+=" {} // <"+k+">\n":(g+=" { // <"+k+">\n",b.forEach(a.attrs,function(a,c){var e=a.name,f=a.value;g+="\n",c>0&&(g+=", "),g+="'"+e+"': ",g+="cjs.concat(",g+=b.map(f,function(a){if(b.isString(a))return"'"+a+"'";var c=a.value.parsed_var_name,e=d(c);return e}).join(", "),g+=")"}),g+="} \n"),b.forEach(a.children,function(a){g+="\n, "+f(a)}),g+="\n) // </"+k+">\n"}else console.log("Unhandled type html/"+j)}else if(h==="mustache"){var j=a.subtype;if(j==="variable"){var l=a.value.parsed_var_name,m=d(l);g="cjs.create('dom_text', "+m+") // {{"+a.value.var_name+"}}\n"}else if(j==="section"){var k=a.value.tag;b.has(e,k)?g=e[k](a):console.log("No helper registered for section "+k)}else console.log("Unhandled type mustache/"+j)}else console.log("Unhandled type "+h);return g},g=a.__parsers.handlebars,h=a.__ir_builders.handlebars,i=function(a,c){var d=g(a),e=h(d),i="with (obj) {\n"+f(e)+"\n}",j;try{j=new Function("obj",i)}catch(k){throw console.log(i),k}return b.isUndefined(c)?j:j(c)};i.register_helper=function(a,b){e[a]=b},a.__template_builders.handlebars=i,i.register_helper("if",function(a){var c=a.parent,e=-1,g=[a],h=!1;for(var i=0;i<c.children.length;i++){var j=c.children[i];if(j===a)h=!0;else if(h){if(j.type!=="mustache"||j.subtype!=="section")break;if(j.value.tag!=="elif"){if(j.value.tag==="else"){g.push(j);break}break}g.push(j)}}var k="\ncjs.create('conditional_constraint', // {{#if}}\n";return b.forEach(g,function(a,c){var e=a.value.parsed_attributes,g=d(e),h=a.value.tag;c>0&&(k+=", "),k+="{ ",h!=="else"&&(k+="condition: "+g,k+=" // {{#"+h+" "+a.value.attributes+"}}\n, "),k+="value: [",b.forEach(a.children,function(a,b){b>0&&(k+=", "),k+=f(a)}),k+="]} // {{/"+h+" "+a.value.attributes+"}}\n"}),k+="\n) // {{/if}}\n",k}),i.register_helper("elif",function(a){return""}),i.register_helper("else",function(a){return""}),i.register_helper("each",function(a){var c=a.value.parsed_attributes,e,g,h,i;c.type==="compound"?i=c.statements:i=[c];var j;if(b.size(i)>=1){var k=d(i[0]),l=b.size(i)>=2?i[1].text:"value",m=b.size(i)>=3?i[2].text:"key";j=k+".map(function("+l+", "+m+") { // {{#each "+i[0].text+"}}\n",j+="return [ // {{#each}}\n",b.forEach(a.children,function(a,b){b>0&&(j+=", "),j+=f(a)}),j+="];",j+="}) // {{/each}}\n"}return j}),i.register_helper("diagram",function(a){var c=d(a.value.parsed_attributes);rv="\ncjs.create('fsm_constraint', "+c+", { // {{#diagram "+c+"}}\n\n";var e=0;return b.forEach(a.children,function(a){if(a.type==="mustache"&&a.subtype==="section"&&a.value.tag==="state"){var c=d(a.value.parsed_attributes);e>0&&(rv+=", "),rv+="'"+c+"': [\n",b.forEach(a.children,function(a,b){b>0&&(rv+=", "),rv+=f(a)}),rv+="]",e++}}),rv+="}) // {/diagram}\n",rv})}(cjs)